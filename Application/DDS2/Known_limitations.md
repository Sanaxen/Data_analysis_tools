# 既知の制限事項または注意事項
## 重要な注意事項
- 本アプリケーションで処理できるデータ量はお使いのPCに搭載されているメモリ容量の制限を受けます。1万行を超えるようなデータは本アプリケーションで処理できるデータ量を超える可能性がありますが読み込み時間、解析計算時間など増大し、本アプリケーションおよびお使いのPCが固まってしまう場合もありますのでご注意ください。  

- データ量が少なすぎる場合では機械学習時のデータ分割で訓練用、テスト用に分割する分割比によっては一方の行数が０に成ってしまう場合があります。その場合はエラーまたは異常終了する場合があります。訓練用、テスト用に分割する分割比で一方のデータ行数が０に成らないようにして下さい。  
- 行数や列数が増えるほど学習には計算時間、消費するメモリ量は増加します。メモリ使用量がお使いのPCに搭載されているメモリ容量を超えると終了する場合があります。 メモリ使用量は稼働しているアプリケーションの状態によって増減しているため搭載メモリ未満の消費メモリ量であっても同様に終了する場合があります。  
- 本アプリケーションを複数起動して実行する場合は作業フォルダーをそれぞれ同一作業フォルダーにならないように変更して下さい。  
- 本アプリケーションで何かの処理を同時並行に実行しないで下さい（ボタンの連打など含む）
- 処理に異常が起きても自動的にリカバリして処理を続行しますがリカバリに失敗すると処理の継続が出来なくなる場合があります。その場合は一度アプリケーションを終了して下さい。  
- バックエンドプロセス(Rterm.exe)が残る場合があります。その場合はタスクマネージャからプロセス(Rterm.exe)終了を行って下さい。  
- 時系列モデルにおいて説明変数をひつようとするモデルでは予測しようとしている期間においても説明変数は必須です。

## 制限事項
データファイルの文字コードはUTF-8 (BOMあり) とShift_JISのみが対応しています。  
ファイル名、フォルダ名で正しい処理が行われないケースがあります。
- 入力フォルダ名やファイル名に日本語が使われている場合
- 数字だけの列名が使われている場合  
 
インタラクティブプロットのプロット状態は再描画するまでデータフレームが変わっても自動的には変わりません。再描画を実行してください。

## 分類問題を扱う場合の注意事項
- 分類問題を扱う場合訓練データとテストデータに分割した場合訓練データには全てのクラスが存在するようにして下さい。テストデータだけにしか無いクラスが存在する場合、テスト時にエラーになる場合があります。
- ロジスティック回帰モデルでは 目的変数は０か１である必要があります。
- AI応用モデルでは全ての変数が数値変数であることが前提です。多クラス分類の場合、クラス番号は０オリジンです。例えばクラスがA,B,Cの場合は３クラスの分類になるのでクラス番号は1,2,3となります。しかし、０オリジンのためこのクラス番号で分類する場合０を含めて４クラスの分類として下さい。
- xgboostモデルではカテゴリ名は数値の0～カテゴリ数-1に揃える必要があります。 ３クラスの分類の場合カテゴリ変数の値は０，１，２である必要があります。
自動でこの調整を行っています。データ内にあるクラス番号の最小値をn、最大値mとするときクラス番号はクラス番号-n に変換されて計算します。元のデータフレームの値は変換されません。  

## 時系列問題を扱う場合の注意事項
- 日時は1970年1月1日0 時0分から3999年12月31日23時59分までが利用可能です。データ内にこの範囲内に無い日時がある場合の正常な計算ができません。
- データ形式の変換では01:02:03 のように時刻だけの場合、Rの時間形式（POSIXlt）への変換情報が不足しているため内部で 1970-01-01 01:02:03 に置換することで変換します。
- AI応用モデルでのclassificationは利用しないでください。

## その他の注意事項
インポートしたデータのオリジナルはファイル名文字列の先頭にi.を付加した変数名でメモリ上に登録されています。アプリの右上にあるComboxに登録されているので選択して「カレントdfに変更」とすると処理対象のデータフレームに出来ます。


## 動作がおかしいな？／変だな？と思った場合

-「既知の制限事項または注意事項」を参照して下さい。
本アプリケーションが実行時にフリーズしてしまった場合、主に以下の事が考えられます。
- 実行時のメモリー不足（１万行を超えるデータを投入していないか？）
- 計算時間が長い
　大抵は長くても数分ですが変数（列数）が数百を超えていると数時間を要する場合があります。

本アプリケーションのバグ

- 数十分たってもフリーズしてしまっている場合はタスクマネージャから強制終了して下さい。
- 強制終了してしまった場合、直前までの操作は全てscriptフォルダにある「直近の作業履歴.r」というスクリプトに保存されています。タブメニューの「Rスクリプト」に読み込んで実行することで直前までの作業を全て再生できます。ただし、完全な再生になっていない場合もありますのでその点はご注意ください。

作業保存を使って作業を保存しておくと「history」から保存してあった作業を復旧することが可能になります。戻したい作業を選択して「右クリック」、「この作業まで復旧」を選択すると作業履歴スクリプトがタブメニューの「Rスクリプト」に読み込まれます。「Run」を実行することで作業履歴スクリプトが実行されて履歴を保存した時点までを再生することが出来ます。この場合も完全な再生になっていない場合もありますのでその点はご注意ください。  

#### 完全な再生になっていない場合の考えられるケース
本アプリケーション内で実行される全てのRスクリプトは削除しない限り全て残されますがRスクリプトが関与しない外部プログラムの実行や外部バッチ処理、手作業でファイルを編集した場合などはその操作・実行は記録されません。


## その他  

<img src=./images/image00.png>

必須では無いが最低限「列名」があると良い。無い場合は自動で列名を付加します。
時系列データは前項のデータフォーマットと形式的には全く同一形式ですが以下の点が異なります。  
時間フォーマットは YYYY-MM-DD または YYYY-MM-DD hh:mm:ss の形式です。
※エクセルで開くと ファイル上はYYYY-MM-DDですが YYYY/MM/DD形式で表示される場合があるので注意して下さい。
<img src=./images/image01.png>


#### 時系列データにおけるイベント効果・説明変数の追加  
祭日やイベントが繰り返しある場合、それらを格納したデータフレームを作成します。そのデータフレームはholidayとdsという2つのカラム及びlower_windowやupper_windowというカラムを追加して、イベント当日の周辺の日までイベント効果が適応される範囲指定します。
例えば、クリスマスの日に加えてクリスマスイブにもイベント効果を適応させたい場合は、
lower_window=-1,upper_window=0とします。さらにprior_scaleカラムを追加することで、事前に各イベント日に対して別々に優先度をつけることができます。
時系列モデルにおいて説明変数をひつようとするモデルでは予測しようとしている期間においても説明変数は必須です。
<img src=./images/image02.png>

